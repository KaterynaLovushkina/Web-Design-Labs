<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!-- CSS only -->
     <link type="text/css" href="{{ url_for('static', filename ='css/style.css') }}" rel='stylesheet'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
</head>
<body>

      <div class="container text-center" id="app">
          <h1 class="bg-light py-4 text-info"><i class="fa-sharp fa-solid fa-earth-americas"></i> Travel Booking</h1>
      </div>
      <div class="container">
          <div class="row">
              <div class="jumbotron p-3 ">
                  <h2 style="display: inline">Mange trips</h2>
                  <div class="buttons float-md-end d-flex justify-content-lg-around flex-wrap">
                      <button type="button" class="btn btn-success m-2" data-bs-toggle="modal" data-bs-target="#mymodal">Add new trip</button>
                      <button type="button" class="btn btn-info m-2" id="btn-sort" onclick="SortPrice()">Sort by Price</button>
                      <a href="/deleteAll" class="btn btn-danger btn-xs m-2" onclick="return confirm('Are you sure to delete all?')">Delete ALL</a>
                      <button type="button" class="btn btn-info m-2" id="btn-count-all" onclick="CountPrice()">Count all Price</button>
                  </div>

                  <div class="container d-flex justify-content-center">
                        <input class="search-bar" type="text" id="search-bar" onkeyup="searchCountry()" placeholder="Search for country..">
                  </div>
                  {% with messages = get_flashed_messages() %}
                  {% if messages %}
                  {% for message in messages %}
                   <div class="alert alert-success alert-dismissible" role="alert">
                   <button type="button" class ='btn-close'data-bs-dismiss="alert" aria-label="Close"></button>
                   {{ message }}
                   </div>
                  {% endfor %}
                  {% endif %}
                  {% endwith %}
              <table id="table" class="table table-striped mt-lg-5 ">
                <thead>
                 <tr>
                  <th data-colname="id" scope="col">ID</th>
                  <th data-type="string" data-colname="country" scope="col">Country</th>
                  <th data-type="number" data-colname="duration" scope="col">Duration</th>
                  <th data-type="number" data-colname="price" scope="col">Price</th>
                  <th data-colname="edit" scope="col">Edit</th>
                  <th data-colname="delete" scope="col">Delete</th>
              </tr>
                  </thead>
              <tbody id ="tbody">
              <div id="total-sum" class="container d-flex justify-content-center"></div>
                {% for row in trips %}
                 <tr>
                 <td>{{ row.id }}</td>
                 <td>{{ row.country }}</td>
                 <td>{{ row.duration }}</td>
                 <td>{{ row.price }}</td>
                 <td><a href="/update/{{ row.id }}" class="btn btn-warning btn-xs" data-bs-toggle="modal" data-bs-target="#modaledit{{ row.id }}">Edit</a></td>
                 <td><a href="/delete/{{ row.id }}" class="btn btn-danger btn-xs" onclick="return confirm('Are you sure to delete?')">Delete</a></td>

                 </tr>

              </tbody>
                    <div id="modaledit{{ row.id}}" class="modal fade" role="dialog">
                    <div class="modal-dialog">
                      <div class="modal-content">
                          <div class="modal-header">
                              <h4 class="modal-title">Update Trip Information</h4>
                          </div>
                          <div class="modal-body">
                              <form id="myform_new" action="/update/{{ row.id }}" method="POST">
                                  <div class="form-group mt-3">
                                      <label  for="country">Country:</label>
                                      <input type="hidden" name="id" value="id">
                                      <input type="text"  class="form-control"  name="country" required value="{{ row.country }}">

                                  </div>
                                  <div class="form-group mt-3">
                                      <label>Duration:</label>
                                      <input type="number"  class="form-control" name="duration" value="{{ row.duration }}" min="3">
                                  </div>
                                  <div class="form-group mt-3">
                                      <label>Price:</label>
                                      <input type="number"  class="form-control" name="price" value="{{ row.price }}" min="7000" step="1000">

                                  </div>
                                  <div class="form-group mt-3">
                                      <button class="btn btn-primary" type="submit">Update</button>
                                  </div>
                              </form>
                          </div>
                          <div class="modal-footer">
                               <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                          </div>
                      </div>
                  </div>
             </div>
                {% endfor %}
          </table>
          </div>
              <div id="mymodal" class="modal fade" role="dialog">
                  <div class="modal-dialog">
                      <div class="modal-content">
                          <div class="modal-header">
                              <h4 class="modal-title">Add Trip</h4>
                          </div>
                          <div class="modal-body">
                              <form id="myform" action="{{url_for('insert')}}" method="POST">
                                  <div class="form-group mt-3">
                                      <label  for="country">Country:</label>
                                      <input type="hidden" name="id" value="id">
                                      <input type="text" id ="country" class="form-control" name="country" required >
                                      <div class="error"></div>
                                  </div>
                                  <div class="form-group mt-3">
                                      <label>Duration:</label>
                                      <input type="number" id ="duration" class="form-control" name="duration" min="3" required>
                                      <div class="error"></div>
                                  </div>
                                  <div class="form-group mt-3">
                                      <label>Price:</label>
                                      <input type="number" id ="price" class="form-control" name="price" min="7000" step="1000" required>
                                      <div class="error"></div>
                                  </div>
                                  <div class="form-group mt-3">
                                      <button class="btn btn-primary" type="submit" >Submit</button>
                                  </div>
                              </form>
                          </div>
                          <div class="modal-footer">
                               <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                          </div>
                      </div>
                  </div>
             </div>
          </div>
      </div>
<!-- JavaScript Bundle with Popper -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
      <script src='{{ url_for('static', filename='index.js') }}'></script>
</body>
</html>